clear
clc
rps=(800+6378)1000;
Ha=800000;
es=0;
m=0.07;
u=398603e9;
R=6378000;
dv=2e􀀀515e3/m;
n=1e8;
Ea=pi/4;
counter=0;
while rps>6578000
as=rps/(1􀀀es);
ra=R+Ha;
va=sqrt(2u/ra􀀀u/as);
Ba=acos(sqrt((es^2􀀀1)/(vara/u(vara/u􀀀2))));
Ea1=Ea􀀀asin(R/rasin(Ea));
vr=dvcos(Ea􀀀Ea1)+vasin(Ba);
vtheta=vacos(Ba)􀀀dvsin(Ea􀀀Ea1);
va1=sqrt(vr^2+vtheta^2);
Ba1=vr/vtheta;
et=sqrt((rava1^2/u􀀀1)^2cos(Ba1)^2+sin(Ba1)^2);
at=ra/(2􀀀rava1^2/u);
rpt=at(1􀀀et);
fa=atan((rava1^2/usin(Ba1)cos(Ba1))/(rava1^2/ucos(Ba1)^2􀀀1));
Ea=2atan(sqrt((1+et)/(1􀀀et)tan(fa/2)));
syms En;
En=solve((En􀀀etsin(En)􀀀Ea+essin(Ea))/sqrt(u/at^3)==1/n);
fn=2atan(tan(En/2)sqrt((1􀀀et)/(1+et)));
rn=at(1􀀀etcos(En));
en1=Ea1􀀀abs(fa􀀀fn);
en=atan(rnsin(en1)/(rncos(en1)􀀀R));
%change
es=et;
rps=rpt;
m=m0.81;
Ha=rps􀀀R;
dv=2e􀀀515e3/m;
fa=fn;
counter=counter+1
